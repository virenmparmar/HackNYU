<!-- add a post to the web page with photo and location and other details -->
{% extends 'base.html' %}

{% block content %}
<div>
    <style>
		.preview {
			display: flex;
			flex-wrap: wrap;
			max-width: 500px;
		}
		.preview img {
			max-width: 150px;
			max-height: 150px;
			margin: 10px;
		}
	</style>
    <title>Add an item for donating</title>

	<form action="#" method="POST" enctype="multipart/form-data">
		{% csrf_token %}
		<div class="mb-3">
			<label for="username" class="form-label">Username</label>
			<input type = "text", id="username", name="username", value="{% user %}">
		</div>

		<label for="post-title">Tell us what is it you are donating:</label><br>
		<input type="text" id="post-title" name="post-title"><br>

		<label for="post-photos">Photos:</label><br>
		<input type="file" id="post-photos" name="post-photos" accepts="image/*" multiple onchange="previewPhotos(event)"><br>
		<div class="preview"></div>

		<label for="post-latitude">Latitude:</label><br>
		<input type="text" id="post-latitude" name="post-latitude"><br>

        <label for="post-longitude">Longitude:</label><br>
		<input type="text" id="post-longitude" name="post-longitude"><br>

		<input type="submit" value="Submit">
	</form>

	<h2>Uploaded File</h2>
	<div>
		{% if file_url %}
		<div>
			<p>Uploaded to:<a href="{{ file_url }}">{{ file_url }}</a></p>
			<img src="{{ file_url }}" class="img-fluid">
		</div>
		{% else %}
		<p> No Picture Added </p>
		{% endif %}
	</div>


	<script>
		function previewPhotos(event) {
			const previewContainer = document.querySelector('.preview');
			previewContainer.innerHTML = '';
			const files = event.target.files;
			for (let i = 0; i < files.length; i++) {
				const file = files[i];
				const reader = new FileReader();
				reader.readAsDataURL(file);
				reader.onload = function() {
					const img = document.createElement('img');
					img.src = reader.result;
					previewContainer.appendChild(img);
				}
			}
		}
	</script>
</div>
{% endblock %}